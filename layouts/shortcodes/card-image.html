{{- $src := cond .IsNamedParams 
  (.Get "src")
  (.Get 0 | replaceRE `^[[][^]]*[]][(]([^)]+)[)]` "$1") 
  -}}
  
{{- $hidden := cond .IsNamedParams 
  (and (.Get "hidden") (eq (.Get "hidden") "true"))
  (and (.Get 1) (eq (.Get 1) "hidden"))  
  -}}

{{- if $src -}}

<img src="{{ $src }}?card-image"{{ if $hidden }} hidden style="display:none"{{ end }} />

{{- end -}}